<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.19236"></meta></head><body>
<p><strong><font color="#0000ff" size="2">Сложная обработка товара.</font></strong></p>
<p>Работает по принципу микро-экселя.</p>
<p><strong>Имя расчетной колонки</strong> - в этом поле указывается имя колонки в которую будет помещен результат расчета по формуле. Если колонки с таким именем в таблице не существует - будет добавлена новая колонка. Это можно использовать для расчета промежуточных значений. Имя созданной колонки после расчета появится в списке доступных параметров, и его можно будет использовать в дальнейших расчетах. </p>
<p>Можно указать имя существующей колонки - в этом случае значения в ней будут пересчитаны по формуле.</p>
<p><strong>Доступные параметры - </strong>в списке доступных параметров показаны те поля , которые можно использовать в формуле расчета. При двойном щелчке мыши на строке из этого списка переменная добавляется в формулу расчета. (Возможно указание полей через точку, например <font color="#9932cc">$СтавкаНДС.Ставка</font><font color="#000000">)</font></p>
<p><strong>Формула для вычисления -</strong> та формула, которую необходимо рассчитать и поместить результат расчета в колонку с именем указанным в поле <strong>имя расчетной колонки</strong>. Текстовые значения указывать в кавычках, например <font color="#9932cc">"РОСС ITАЯ58В36968"</font> , дробные числовые значения указывать через точку, например <font color="#9932cc">14.375 </font><font color="#000000">.</font></p>
<p>Можно использовать функцию <strong>?(,,)</strong> для вычисления значений зависящих от неких условий см. ниже в <font color="#0000ff"><strong>приложении</strong></font>.</p>
<p>Выглядеть формула должна например так:<font color="#006400"> </font></p>
<p><font color="#006400"><font color="#9932cc">$ЦенаЗакуп+ $ЦенаЗакуп/100*10</font> </font></p>
<p>В этом случае результат будет числовой,</p>
<p>Или так:  </p>
<p><font color="#006400"><font color="#9932cc">$ЦенаЗакуп &lt;= $ЦенаПроизводителя</font> </font></p>
<p>в этом случае тезультат будет типа Булево (Истина или Ложь) , такого типа формулы используются, в основном, для расчета колонки удаления.</p>
<p><strong><font color="#006400" size="2">Кнопки.</font></strong></p>
<p><strong>Вычислить расчетную колонку</strong> - производит построчный расчет по формуле и помещает результат расчета в указанную  в поле <strong>имя расчетной колонки </strong>колонку таблицы.</p>
<p><strong>Вычислить колонку удаления</strong> - производит построчный расчет по формуле и помещает результат расчета в колонку Удалить. Важно: результат расчета по формуле должен иметь тип Булево (Истина или Ложь), в противном случае будет выведено сообщение об ошибке и значение расчета будет Ложь.</p>
<p><strong>Удалить строки</strong> - удаляет из таблицы строки, у которых в колонке Удалить стоит Истина.</p>
<p><strong>Результат обработки в документ </strong>- помещает таблицу в документ, заменяя собой существующую.</p>
<p><strong><font color="#006400" size="2">Алгоритм работы.</font></strong></p>
<p>1) Создать формулу.</p>
<p>2) Вычислить расчетную колонку.</p>
<p>.... повторить пункты 1) 2) требуемое количество раз ....</p>
<p>3) Создать формулу, результатом вычисления которой будет Булево.</p>
<p>4) Вычислить колонку удаления.</p>
<p>5) Удалить строки.</p>
<p>6) Перенести Результат обработки в документ.</p>
<p> </p>
<p><font color="#0000ff" size="2"><strong>При</strong></font><font color="#0000ff" size="2"><strong>ложение. Некоторые полезные функции.</strong></font></p>
<p><strong>Функция ?(,,) </strong></p>
<p>?(&lt;Логическое выражение&gt;, &lt;Выражение 1&gt;, &lt;Выражение 2&gt;)</p>
<p>Параметры:<br><u>&lt;Логическое выражение&gt;</u></p>
<p>Напрмер <font color="#9932cc">$ЦенаЗакуп &lt;= $ЦенаПроизводителя</font><font color="#006400"> </font><br>Логическое выражение, результат вычисления которого определяет одно из результирующих выражений, которые будут вычислены. Если результат его вычисления <a href="v8help://SyntaxHelperLanguage/def_BooleanTrue"><font color="#000080">Истина</font></a>, то будет вычисляться &lt;Выражение 1&gt;. Если результат <a href="v8help://SyntaxHelperLanguage/def_BooleanFalse"><font color="#000080">Ложь</font></a> – то &lt;Выражение 2&gt;.<br><u></u></p>
<p><u>&lt;Выражение 1&gt;</u><br>Результирующее выражение, которое будет вычисляться, если результат логического выражения <a href="v8help://SyntaxHelperLanguage/def_BooleanTrue"><font color="#000080">Истина</font></a>.<br><u></u></p>
<p><u>&lt;Выражение 2&gt;<br></u>Результирующее выражение, которое будет вычисляться, если результат логического выражения <a href="v8help://SyntaxHelperLanguage/def_BooleanFalse"><font color="#000080">Ложь</font></a></p>
<p>Возвращаемое значение:<br>Результат вычисления одного из результирующих выражений. </p>
<p><strong>Функция Окр(,)</strong></p>
<div class="V8SH_chapter">Синтаксис:</div>
<p>Окр(&lt;Число&gt;, &lt;Разрядность&gt;, &lt;Режим округления&gt;) </p>
<div class="V8SH_chapter">Параметры:</div>
<div class="V8SH_rubric">&lt;Число&gt; (обязательный)</div>
<p>Тип: <a href="v8help://SyntaxHelperLanguage/def_Number"><font color="#000080">Число</font></a>. Исходное число. </p>
<div class="V8SH_rubric">&lt;Разрядность&gt; (необязательный)</div>
<p>Тип: <a href="v8help://SyntaxHelperLanguage/def_Number"><font color="#000080">Число</font></a>. Определяет число знаков дробной части, до которых производится округление. Если параметр отрицательный, то число округляется до соответствующего разряда в целой части, начиная с младших разрядов.<br>Параметр обязательный, если указан параметр &lt;Режим округления&gt;.<br>Значение по умолчанию: 0 </p>
<div class="V8SH_rubric">&lt;Режим округления&gt; (необязательный)</div>
<p>Тип: <a href="v8help://SyntaxHelperContext/objects/catalog2/catalog1016/RoundMode.html"><font color="#000080">РежимОкругления</font></a>. Определяет режим округления. Помимо системного перечисления допускается использование числового параметра: 0 - если при округлении 1.5 = 1; 1 - если при округлении 1.5 = 2.<br>Значение по умолчанию: <a href="v8help://SyntaxHelperContext/objects/catalog2/catalog1016/RoundMode/properties/Round15as201545.html"><font color="#000080">Окр15как20</font></a> </p>
<p> </p>
<div class="V8SH_heading"><strong>Функция Цел ()</strong></div>
<div class="V8SH_chapter">Синтаксис:</div>
<p>Цел(&lt;Число&gt;) </p>
<div class="V8SH_chapter">Параметры:</div>
<div class="V8SH_rubric">&lt;Число&gt; (обязательный)</div>
<p>Тип: <a href="v8help://SyntaxHelperLanguage/def_Number"><font color="#000080">Число</font></a>. Исходное число. </p>
<p>Возвращаемое значение: Результат выделения целой части. например <font color="#9932cc">Цел(4.567) даст 4 , а   4.567-Цел(4.567) даст соответственно 0.567</font></p>
<p> </p>
<p><strong>Функция ОМ3_ОтброситьДо10Коп (&lt;Сумма&gt;)</strong></p>
<p>Округляет сумму до 10 копеек, путем отбрасывания сотых. Например <font color="#9932cc"> ОМ3_ОтброситьДо10Коп (123.36) даст 123.30</font></p></body></html>