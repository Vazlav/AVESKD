
Процедура ДокументСписокПриАктивизацииСтроки(Элемент)
	
	Если НЕ ЭлементыФормы.ДокументСписок.ТекущиеДанные = Неопределено Тогда
		ЭлементыФормы.ТекстДокОснование.Заголовок = ЭлементыФормы.ДокументСписок.ТекущиеДанные.ДокОснование;
	КонецЕсли;
	
КонецПроцедуры

Процедура ТекстДокОснованиеНажатие(Элемент)
	
	Док = ЭлементыФормы.ДокументСписок.ТекущиеДанные.ДокОснование;
	Док.ПолучитьФорму().Открыть();
	
КонецПроцедуры

Процедура ДействияФормыкнЗакрытьЗаказ(Кнопка)
	
	Если НЕ ЭлементыФормы.ДокументСписок.ТекущиеДанные = Неопределено Тогда
		
		Режим = РежимДиалогаВопрос.ДаНет;
		Ответ = Вопрос("Продолжить выполнение закрытия заказа?", Режим, 0);
		Если Ответ = КодВозвратаДиалога.Нет Тогда
			Возврат;
		КонецЕсли; 
		
		
		Док = ЭлементыФормы.ДокументСписок.ТекущаяСтрока;
		Если Док.Проведен  = Истина Тогда
			ДокОбъект = Док.ПолучитьОбъект();		
			
			ТаблицаЗакрытия = ДокОбъект.ПолучитьТаблицуТовараВПутиПоЗаказу();
			Если ТаблицаЗакрытия = Неопределено Тогда
				Предупреждение("Нет данных для закрытия заказа. Возможно заказ был уже закрыт.");
			Иначе
				ДокОбъект.ЗакрытьЗаказ(ТаблицаЗакрытия);
				
				СтрокаИзменений = ДокОбъект.Изменения.Добавить();
				СтрокаИзменений.Дата = ТекущаяДата();
				СтрокаИзменений.КомментарийИзменения = "Интерактивное закрытие заказа";
				СтрокаИзменений.Сотрудник = ПараметрыСеанса.ТекущийСотр;
				СтрокаИзменений.ТипИзм = Перечисления.ДействияНадДокументами.Изменение;
				ДокОбъект.Записать(РежимЗаписиДокумента.Запись);
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
	

	
КонецПроцедуры

Процедура ПоставщикПриИзменении(Элемент)
	
	ЕстьОтборПоПоставщику=ЗначениеЗаполнено(Элемент.Значение);
	Если ТипЗнч(ЭлементыФормы.Поставщик.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.Поставщик.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.Поставщик.ВидСравнения=ВидСравнения.Равно;
	КонецЕсли; 
	
	Отбор.Поставщик.Использование=ЕстьОтборПоПоставщику;

КонецПроцедуры

Процедура СкладПриИзменении(Элемент)
	
	ЕстьОтборПоСкладу=ЗначениеЗаполнено(Элемент.Значение);
	Если ТипЗнч(ЭлементыФормы.Склад.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.Склад.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.Склад.ВидСравнения=ВидСравнения.Равно;
	КонецЕсли; 
	
	Отбор.Склад.Использование=ЕстьОтборПоСкладу;
	
КонецПроцедуры

Процедура кнСброситьФильтрыНажатие(Элемент)
	
	Отбор.Поставщик.Использование=Ложь;
	Отбор.Склад.Использование=Ложь;
	ЭлементыФормы.Поставщик.Значение = Справочники.Поставщики.ПустаяСсылка();
	ЭлементыФормы.Склад.Значение 	 = Справочники.МестаХранения.ПустаяСсылка();
	
КонецПроцедуры

Отбор.Дата.Значение = НачалоДня(ТекущаяДата()-24*60*60*3);
Отбор.Дата.ВидСравнения = ВидСравнения.БольшеИлиРавно;
Отбор.Дата.Использование = Истина;
