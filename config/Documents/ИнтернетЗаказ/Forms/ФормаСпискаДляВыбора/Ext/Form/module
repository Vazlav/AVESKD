
Процедура ДействияФормыПотребностьВТоваре(Кнопка)
	
	Отчет=Отчеты.ПотребностьИнтернетАптеки.Создать();
	Отчет.Склад=ОМ41_СкладИФирмаТекущегоПользователя().Аптека;
	
	Отчет.ПолучитьФорму("ФормаОтчета").Открыть();
	
	
КонецПроцедуры

Процедура БыстрыйФильтрПриИзменении(Элемент)
	
	//Зашито в список выбора элемента формы, см. свойства элемента формы
	
	ОтборПоСтатусу=ДокументСписок.Отбор.Найти("СтатусЗаказа");
	
	Если БыстрыйФильтр="ВсеЗаказы" тогда
		ОтборПоСтатусу.Использование=Ложь;
		
	ИначеЕсли БыстрыйФильтр="НовыеЗаказы" Тогда
		ОтборПоСтатусу.Использование=Истина;    
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.Равно;
		
		ОтборПоСтатусу.Значение=Перечисления.ИА_СтатусЗаказа.Зарегистрирован;
		
	ИначеЕсли БыстрыйФильтр="НовыеЗаказыИНекомплект" Тогда
		ОтборПоСтатусу.Использование=Истина;
		СписокСтатусов=Новый списокзначений;
		СписокСтатусов.Добавить(Перечисления.ИА_СтатусЗаказа.Зарегистрирован);
		СписокСтатусов.Добавить(Перечисления.ИА_СтатусЗаказа.НекомплектЗаказан);
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.ВСписке;
		
		ОтборПоСтатусу.Значение=СписокСтатусов;
	ИначеЕсли БыстрыйФильтр="Собран" Тогда
		ОтборПоСтатусу.Использование=Истина;
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.Равно;
		ОтборПоСтатусу.Значение=Перечисления.ИА_СтатусЗаказа.Собран;
		
	ИначеЕсли БыстрыйФильтр="Некомплект" Тогда
		ОтборПоСтатусу.Использование=Истина;
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.Равно;
		ОтборПоСтатусу.Значение=Перечисления.ИА_СтатусЗаказа.НеКомплект;
	ИначеЕсли БыстрыйФильтр="НекомплектЗаказан" Тогда
		ОтборПоСтатусу.Использование=Истина;
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.Равно;
		
		ОтборПоСтатусу.Значение=Перечисления.ИА_СтатусЗаказа.НекомплектЗаказан;
	ИначеЕсли БыстрыйФильтр="ВесьНекомплект" Тогда
		ОтборПоСтатусу.Использование=Истина;
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.ВСписке;
		СписокСтатусов=Новый списокзначений;
		СписокСтатусов.Добавить(Перечисления.ИА_СтатусЗаказа.НеКомплект);
		СписокСтатусов.Добавить(Перечисления.ИА_СтатусЗаказа.НекомплектЗаказан);
		
		ОтборПоСтатусу.Значение=СписокСтатусов;
		
		
		
	ИначеЕсли БыстрыйФильтр="ВПути" Тогда
		ОтборПоСтатусу.Использование=Истина;
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.Равно;
		
		ОтборПоСтатусу.Значение=Перечисления.ИА_СтатусЗаказа.ВПути;
	ИначеЕсли БыстрыйФильтр="Оплачен" Тогда
		ОтборПоСтатусу.Использование=Истина;
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.Равно;
		
		ОтборПоСтатусу.Значение=Перечисления.ИА_СтатусЗаказа.Оплачен;
	ИначеЕсли БыстрыйФильтр="Отказы" Тогда
		ОтборПоСтатусу.ВидСравнения=ВидСравнения.Равно;
		
		ОтборПоСтатусу.Использование=Истина;
		ОтборПоСтатусу.Значение=Перечисления.ИА_СтатусЗаказа.Отказ;
	КонецЕсли;
	
	
	
	
	
	
	
	
	
	
	
	
КонецПроцедуры

Процедура ТоварВЗаказеОчистка(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка=ЛОжь;
	ОтботПоТовару=ДокументСписок.Отбор.Найти("ТоварВИнтернетЗаказе");
	ОтботПоТовару.Значение=Справочники.АССОРТИМЕНТНЫЙ_ПЛАН.ПустаяСсылка();
	ОтботПоТовару.Использование=Ложь;
	ЭлементыФормы.ТоварВЗаказе.Значение=Справочники.АССОРТИМЕНТНЫЙ_ПЛАН.ПустаяСсылка();
КонецПроцедуры

Процедура ТоварВЗаказеПриИзменении(Элемент)
	ОтботПоТовару=ДокументСписок.Отбор.Найти("ТоварВИнтернетЗаказе");
	ОтботПоТовару.Использование=Не ПустаяСтрока(ОтботПоТовару.Значение);
	
КонецПроцедуры

Процедура СтатусЗаказаПриИзменении(Элемент)
	ЕстьОтборПоСтатусу=ЗначениеЗаполнено(Элемент.Значение);
	Если ТипЗнч(Элемент.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.СтатусЗаказа.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.СтатусЗаказа.ВидСравнения=ВидСравнения.Равно;
	КонецЕсли; 
	
	Отбор.СтатусЗаказа.Использование=ЕстьОтборПоСтатусу;

КонецПроцедуры

Процедура СтатусЗаказаОчистка(Элемент, СтандартнаяОбработка)
		СтандартнаяОбработка=Ложь;

	Элемент.Значение=Перечисления.ИА_СтатусЗаказа.ПустаяСсылка();
	СтатусЗаказаПриИзменении(Элемент) ;

КонецПроцедуры

Процедура ДатаОтгрузкиПриИзменении(Элемент)
	Если Элемент.Значение=Дата("00010101") Тогда
		ЕстьОтборПоДО= Ложь;
	Иначе
		ЕстьОтборПоДО=Истина;
	КонецЕсли;
	
	Если ТипЗнч(Элемент.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.ДатаОтгрузки.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.ДатаОтгрузки.ВидСравнения=ВидСравнения.Равно;
	КонецЕсли; 
	
	Отбор.ДатаОтгрузки.Использование=ЕстьОтборПоДО;


КонецПроцедуры

Процедура ДатаОтгрузкиОчистка(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка=Ложь;
	Элемент.Значение=Дата("00010101");
	ДатаОтгрузкиПриИзменении(Элемент);

КонецПроцедуры

Процедура ОсновныеДействияФормыЗаявкаНаПеремещение(Кнопка)
	
	ДокСсылка=ЭлементыФормы.ДокументСписок.ТекущаяСтрока;
	
	ГенЗаказа=Обработки.ГенераторЗаявкиНаПеремещениеВОнлайнЗону.Создать();
	ГенЗаказа.Заказ=ДокСсылка;
	ГенЗаказа.Аптека=ДокСсылка.ФизическаяАптека;
	ГенЗаказа.ОнлайнЗона=ДокСсылка.Склад;
	
	ГенЗаказа.МО_ВыгрузитьЗаказ(ДокСсылка);
	предупреждение("Выгружена заявка на перемещение товара ",10);
	
КонецПроцедуры

Процедура ОсновныеДействияФормыЭкспЗаявкаНаПеремещение(Кнопка)
	ДокСсылка=ЭлементыФормы.ДокументСписок.ТекущаяСтрока;
	
	ГенЗаказа=Обработки.ГенераторЗаявкиНаПеремещениеВОнлайнЗону.Создать();
	ГенЗаказа.Заказ=ДокСсылка;
	ГенЗаказа.Аптека=ДокСсылка.ФизическаяАптека;
	ГенЗаказа.ОнлайнЗона=ДокСсылка.Склад;
	
	ГенЗаказа.ПолучитьФорму("Форма").Открыть();
	
	
	
КонецПроцедуры

Процедура ПриОткрытии()
	ДатаОтгрузки=Дата("00010101");
	СтатусЗаказа=Перечисления.ИА_СтатусЗаказа.ПустаяСсылка();
КонецПроцедуры

Процедура ДокументСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	Если ДанныеСтроки.ЕстьТоварСЦенойНоль = Истина Тогда
		ОформлениеСтроки.ЦветФона=Новый Цвет(255,245,130);
	КонецЕсли;
	
	Если ДанныеСтроки.ВидИнтернетЗаказа = Перечисления.ВидыИнтернетЗаказа.ИндивидуальныйЗаказ Тогда
		ОформлениеСтроки.ЦветФона=Новый Цвет(176,224,230);
	КонецЕсли;


КонецПроцедуры



ТоварВЗаказе=Справочники.АССОРТИМЕНТНЫЙ_ПЛАН.ПустаяСсылка();
ДокументСписок.Отбор.Найти("ТоварВИнтернетЗаказе").Использование=Ложь;