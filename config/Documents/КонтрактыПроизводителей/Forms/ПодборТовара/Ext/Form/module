

Процедура ОсновныеДействияФормыкнПеренестиВДокумент(Кнопка)
	
	ОповеститьОВыборе(ТЗТовара);	
	
КонецПроцедуры

Процедура СправочникТовараВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;	

	Бонус = 0;
	Если ВвестиЧисло(Бонус, "Введите значение оптового бонуса", 10, 2) Тогда
		
		БонусСО = 0;
		ВвестиЧисло(БонусСО, "Введите значение бонуса СО", 10, 2);
		
		ТП = 0;
		ВвестиЧисло(ТП, "Введите значение таможенной пошлины", 10, 2);
			
		СтрТовар = ВыбраннаяСтрока;
		Отбор = Новый Структура;
		Отбор.Вставить("Товар",СтрТовар);
		НайденнаяСтрока = ТЗТовара.Найти(СтрТовар,"Товар");
		Если НайденнаяСтрока = Неопределено Тогда
			НоваяСтрока = ТЗТовара.Добавить();
			НоваяСтрока.КодТовара		= СтрТовар.Код;
			НоваяСтрока.Товар			= СтрТовар;
			НоваяСтрока.БонусОптовый	= Бонус;
			//НоваяСтрока.СтавкаНДС		= СтрТовар.СтавкаНДС.Ставка;
			НоваяСтрока.СтавкаНДС		= ПереопределениеЗначенияСтавки20_18(СтрТовар.СтавкаНДС,ВладелецФормы.Дата);
			НоваяСтрока.БонусСО			= БонусСО;
			НоваяСтрока.БонусТП			= ТП;
		Иначе
			НайденнаяСтрока.БонусОптовый	= Бонус;			
			НайденнаяСтрока.БонусСО			= БонусСО;			
			НайденнаяСтрока.БонусТП			= ТП;			
		КонецЕсли;
	КонецЕсли; 	
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	ТЗТовара = ВладелецФормы.Товар.Выгрузить();
	
	ОтборПоПроизводителю=СправочникТовара.Отбор.Найти("Производитель");	
	Если НЕ ОтборПоПроизводителю = Неопределено и НЕ ВладелецФормы.Производитель.Пустая() Тогда
		ОтборПоПроизводителю.ВидСравнения=ВидСравнения.Равно;
		ОтборПоПроизводителю.Значение=ВладелецФормы.Производитель;
		ОтборПоПроизводителю.Использование=Истина;
	 КонецЕсли;

КонецПроцедуры
