
Процедура ДействияФормыВыгрузитьВАптеку(Кнопка)
	
	Док = ЭлементыФормы.ДокументСписок.ТекущаяСтрока;
	Если Док.Проведен = Истина Тогда
		
		ДокОбъект = Док.ПолучитьОбъект();
		Если ДокОбъект.ВыгрузитьВАптеку() = Истина Тогда
			Предупреждение("Документ выгружен!");
		Иначе
			Предупреждение("Документ НЕ выгружен!");
		КонецЕсли;
	Иначе
		Предупреждение("Можно выгружать только проведенный документ!");
	КонецЕсли;	
	
КонецПроцедуры

Процедура ПоставщикПриИзменении(Элемент)
	
	ЕстьОтборПоПоставщику=ЗначениеЗаполнено(Элемент.Значение);
	Если ТипЗнч(ЭлементыФормы.Поставщик.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.Поставщик.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.Поставщик.ВидСравнения=ВидСравнения.Равно;
	КонецЕсли; 
	
	Отбор.Поставщик.Использование=ЕстьОтборПоПоставщику;
	
	
	
КонецПроцедуры

Процедура СкладПриИзменении(Элемент)
	
	ЕстьОтборПоСкладу=ЗначениеЗаполнено(Элемент.Значение);
	Если ТипЗнч(ЭлементыФормы.Склад.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.Склад.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.Склад.ВидСравнения=ВидСравнения.Равно;
	КонецЕсли; 
	
	Отбор.Склад.Использование=ЕстьОтборПоСкладу;
	
	
КонецПроцедуры

Процедура НомерНакладнойПриИзменении(Элемент)
	
	ЕстьОтборПоНакладной=ЗначениеЗаполнено(Элемент.Значение);
	Если ТипЗнч(Элемент.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.ВхНомерНакл.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.ВхНомерНакл.ВидСравнения=ВидСравнения.Содержит;
	КонецЕсли; 
	
	Отбор.ВхНомерНакл.Использование=ЕстьОтборПоНакладной;
	
	
КонецПроцедуры


Процедура ФирмаПриИзменении(Элемент)
	
	
	ЕстьОтборПоФирме=ЗначениеЗаполнено(Элемент.Значение);
	Если ТипЗнч(Элемент.Значение)=Тип("СписокЗначений") ТОгда
		Отбор.Фирма.ВидСравнения=ВидСравнения.ВСписке;
	Иначе
		Отбор.Фирма.ВидСравнения=ВидСравнения.Равно;
	КонецЕсли; 
	
	Отбор.Фирма.Использование=ЕстьОтборПоФирме;
	
	
КонецПроцедуры


Процедура СброситьФильтрыНажатие(Элемент)
	//Отбор.Сбросить();
	
	Отбор.Фирма.Использование=Ложь;
	Отбор.Поставщик.Использование=Ложь;
	Отбор.Склад.Использование=Ложь;
	Отбор.ВхНомерНакл.Использование=Ложь;
	ЭлементыФормы.Поставщик.Значение = Справочники.Поставщики.ПустаяСсылка();
	ЭлементыФормы.Фирма.Значение 	 = Справочники.Фирмы.ПустаяСсылка();
	ЭлементыФормы.Склад.Значение 	 = Справочники.МестаХранения.ПустаяСсылка();
	ЭлементыФормы.НомерНакладной.Значение = "";
	
КонецПроцедуры

Процедура КоманднаяПанель1ДобавитьВСписок(Кнопка)
	
	Построитель.Выполнить();
	СА=Построитель.Результат.Выгрузить().ВыгрузитьКолонку("ссылка");
	СписокАптек.Очистить();
	СписокАптек.ЗагрузитьЗначения(СА);
	СписокАптек.ЗаполнитьПометки(Истина);
	
	
КонецПроцедуры

Процедура КоманднаяПанель2УстановитьФильтрПоВыбраннымАптекам(Кнопка)
	
	ОС=Отбор.Найти("Склад");
	ОС.ВидСравнения=ВидСравнения.ВСписке;
	ОС.Значение=СписокАптек;
	ОС.Использование=Истина;
КонецПроцедуры

Процедура ДокументСписокПередУстановкойПометкиУдаления(Элемент, Отказ)
	
	//ТекСтр = Элемент.ТекущаяСтрока;
	//Если ТекСтр.Склад.АптекаНаНовомПо = Истина Тогда
	//	Отказ = Истина;
	//КонецЕсли;
	
КонецПроцедуры

Процедура ДокументСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	
	Если ДанныеСтроки.Статус = Перечисления.СтатусПрихода.ПроблемыВАптеке Тогда
		ОформлениеСтроки.ЦветФона=Новый Цвет(238,238,111);
	КонецЕсли; 
	Если ДанныеСтроки.СтатусДокАптеки = Перечисления.СтатусДокАптеки.Аннулирован или ДанныеСтроки.Статус = Перечисления.СтатусПрихода.Аннулирован Тогда
		ОформлениеСтроки.ЦветФона=Новый Цвет(255,179,179);
	КонецЕсли;
	
КонецПроцедуры

Процедура ДокументСписокПередНачаломДобавления(Элемент, Отказ, Копирование)
	
	Если Копирование = истина Тогда
		Предупреждение("Копирование документов запрещено!");
		Отказ = Истина;	
	КонецЕсли;
	
КонецПроцедуры

Отбор.Дата.Значение = НачалоМесяца(ТекущаяДата()-24*60*60*35);
Отбор.Дата.ВидСравнения = ВидСравнения.БольшеИлиРавно;
Отбор.Дата.Использование = Истина;

Построитель.Текст="ВЫБРАТЬ
                  |	МестаХранения.Ссылка
                  |ИЗ
                  |	Справочник.МестаХранения КАК МестаХранения
                  |{ГДЕ
                  |	МестаХранения.Ссылка.* КАК Аптека}"; 