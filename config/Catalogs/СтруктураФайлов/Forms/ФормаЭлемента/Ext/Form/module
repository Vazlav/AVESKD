Перем СписокВыбораПрайс;
Перем СписокВыбораОтказы;
Перем СписокВыбораОтказыТЧ;
Перем СписокВыбораТЧ;

Процедура Заказ1ИмяПоляНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	Элемент.СписокВыбора = СписокВыбораПрайс;
КонецПроцедуры

Процедура ПриОткрытии()
	СписокВыбораПрайс = Новый СписокЗначений;
	ФайлПрайсЛиста = ЭтотОбъект.Владелец.ФайлПрайсЛиста;
	ДБФ = Новый XBASE;
	Попытка
		ДБФ.ОткрытьФайл(ФайлПрайсЛиста);
	Исключение
		Сообщить("Не удалось открыть файл прайс листа!" + ФайлПрайсЛиста);
		Возврат;
	КонецПопытки;
	
	Для к = 0 по ДБФ.поля.Количество() - 1 Цикл
		СписокВыбораПрайс.Добавить(ДБФ.поля.Получить(к).Имя);
	КонецЦикла;
	ДБФ.ЗакрытьФайл();
	

	СписокВыбораТЧ = Новый СписокЗначений;
	МетаданныеИзмерения = Метаданные.РегистрыСведений.Прайсы.Измерения;
	Для к = 0 по МетаданныеИзмерения.Количество() - 1 Цикл
		СписокВыбораТЧ.Добавить(МетаданныеИзмерения.Получить(к).Имя);
	КонецЦикла;
	
	МетаданныеРесурсы = Метаданные.РегистрыСведений.Прайсы.Ресурсы;
	Для к = 0 по МетаданныеРесурсы.Количество() - 1 Цикл
		СписокВыбораТЧ.Добавить(МетаданныеРесурсы.Получить(к).Имя);
	КонецЦикла;
	
	
КонецПроцедуры

Процедура Заказ1ПолеТЧНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	Элемент.СписокВыбора = СписокВыбораТЧ;
КонецПроцедуры

Процедура Заказ1ПолеТЧОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	Элемент.Значение = ВыбранноеЗначение;
КонецПроцедуры

Процедура Заказ1ИмяПоляОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	Элемент.Значение = ВыбранноеЗначение;
КонецПроцедуры

Процедура ВыборФайла(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	ДВФ = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие ); 
	ДВФ.МножественныйВыбор=Ложь;
	если двф.Выбрать() тогда
	     ЭлементыФормы[Элемент.Имя].Значение=(СокрЛп(ДВФ.ПолноеИмяФайла));
    Иначе
	КонецЕсли;
	

КонецПроцедуры

Процедура СформироватьСтруктуруПолейОтказовНажатие(Элемент)
	
	Если ПустаяСтрока(ПримерФайлаОтказа) = Истина Тогда
		Предупреждение("Не выбран пример файла отказа.");	
		Возврат;
	КонецЕсли;
	
	СписокВыбораОтказы = Новый СписокЗначений;
	
	ДБФ = Новый XBASE;
	Попытка
		ДБФ.ОткрытьФайл(СокрЛП(ПримерФайлаОтказа));
	Исключение
		Сообщить(ОписаниеОшибки());
		Возврат;
	КонецПопытки;
	
	Если ДБФ.Открыта() Тогда
		Для Ц=0 По ДБФ.поля.Количество()-1 Цикл
			СписокВыбораОтказы.Добавить(ДБФ.поля[Ц].Имя);
		КонецЦикла;
	КонецЕсли;
	
	СписокВыбораОтказыТЧ = Новый СписокЗначений;
	СписокВыбораОтказыТЧ.Добавить("НомерЗаказа");
	СписокВыбораОтказыТЧ.Добавить("ДатаЗаказа");
	СписокВыбораОтказыТЧ.Добавить("КодТовараПоставщика");
	СписокВыбораОтказыТЧ.Добавить("Количество");
	СписокВыбораОтказыТЧ.Добавить("Цена");
	СписокВыбораОтказыТЧ.Добавить("КодПолучателя");
	
	
	
КонецПроцедуры

Процедура ОтказыИмяПоляНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	Элемент.СписокВыбора = СписокВыбораОтказы;
КонецПроцедуры

Процедура ОтказыИмяПоляОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	Элемент.Значение = ВыбранноеЗначение;
КонецПроцедуры

Процедура ОтказыПолеТЧНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	Элемент.СписокВыбора = СписокВыбораОтказыТЧ;
КонецПроцедуры

Процедура ОтказыПолеТЧОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	Элемент.Значение = ВыбранноеЗначение;
КонецПроцедуры

Процедура ПередЗаписью(Отказ)
	Наименование = "Имя";
КонецПроцедуры
