
Процедура КнопкиСформировать(Кнопка)
	
	ТЗ = Новый ТаблицаЗначений;
	ТЗ.Колонки.Добавить("Код2005");
	ТЗ.Колонки.Добавить("КодПост");
	ТЗ.Колонки.Добавить("Имя2005");
	ТЗ.Колонки.Добавить("ИмяПост");
	АдоЦБ=Новый COMОбъект ("AdoDB.Connection");
	АдоЦБ_КоннСтр="DSN=A5_Sklad; Password=;User ID=sa";
	АдоЦБ.Open(АдоЦБ_КоннСтр);
	
	текст = "select * from pricepost";
	
	Рез = ОМ8_ВыполнитьSQLЗапросКВнешнейБД(АдоЦБ,текст,0,1,0); // ---- by  GtG ---- 
	
	Попытка
		Рез.MoveFirst();
		
	Исключение
		Предупреждение("Запрос к базе не выполнен");
	КонецПопытки;
	
	Пока Рез.EOF() = 0 Цикл
		стр = ТЗ.Добавить();
		стр.Код2005 = Рез.Fields(0).Value;
		стр.КодПост = Рез.Fields(1).Value;
		стр.Имя2005 = Рез.Fields(2).Value;
		стр.ИмяПост = Рез.Fields(3).Value;
		Рез.MoveNext();
	КонецЦикла;
	
	ЭлементыФормы.ТабличноеПоле1.Значение = ТЗ;
	ЭлементыФормы.ТабличноеПоле1.СоздатьКолонки();
	
КонецПроцедуры
