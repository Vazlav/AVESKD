
Процедура кнНастройкаТранспортаНажатие(Элемент)
	
	
	Если ЭтоНовый() Тогда
		Предупреждение("Перед вызовом настройки обмена необходимо записать элемент");
		Возврат;
	КонецЕсли;
	
	Настройка = ЭтотОбъект.ПолучитьФорму("НастройкаТранспорта");
	Настройка.ВладелецФормы = ЭтаФорма;
	Настройка.КодКонтракта = Код;
	Настройка.НастройкаОбмена = Ссылка;
	Настройка.ОткрытьМодально();

	
КонецПроцедуры

Процедура ПриОткрытии()
	
	Если ЭтоНовый() Тогда
		КодПоставщика = Владелец.Код;
		СуммаПороговая = Владелец.СуммаПороговаяЗаказа;
		СуммаМинимальногоЗаказа = Владелец.СуммаМинимальногоЗаказа;
		КоэффициентПриведенияЦены = Владелец.КоэффициентПриведенияЦены;
		КоэффициентПриведенияЦеныДляЖНВЛС = Владелец.КоэффициентПриведенияЦеныДляЖНВЛС;
		КоэффициентПриведенияЦеныКромеЖНВЛС = Владелец.КоэффициентПриведенияЦеныКромеЖНВЛС;
		КоэффициентЦеныНаБазовыйПрайсПоставщика = Владелец.КоэффициентЦеныНаБазовыйПрайсПоставщика;
		АвтоЗагрузкаНакладных = Владелец.АвтоматическаяЗагрузкаНакладных;
		АвтоВыгрузкаЗаказов = Владелец.АвтоматическаяВыгрузкаЗаказов;
		МинимальныйСрокГодности = 3;
		
		ЭлементыФормы.НаличиеНастройкиОбмена.Заголовок = " >> Отсутствует настройка обмена << ";
		ЭлементыФормы.НаличиеНастройкиОбмена.ЦветТекста = Новый Цвет(255,0,0);	
		ЭлементыФормы.НаличиеНастройкиФорматов.Заголовок = " >> Отсутствует настройка форматов << ";
		ЭлементыФормы.НаличиеНастройкиФорматов.ЦветТекста = Новый Цвет(255,0,0);
		
	Иначе
		НЗ = РегистрыСведений.НастройкиОбмена.СоздатьНаборЗаписей();
		НЗ.Отбор.НастройкаОбмена.Установить(Ссылка);
		НЗ.Прочитать();

		Если НЗ.Количество() Тогда
			ЭлементыФормы.НаличиеНастройкиОбмена.Заголовок = " >> Есть настройка обмена << ";	
			ЭлементыФормы.НаличиеНастройкиОбмена.ЦветТекста = Новый Цвет(159,101,0);
		Иначе
			ЭлементыФормы.НаличиеНастройкиОбмена.Заголовок = " >> Отсутствует настройка обмена << ";
			ЭлементыФормы.НаличиеНастройкиОбмена.ЦветТекста = Новый Цвет(255,0,0);
		КонецЕсли;
		
		НЗ = РегистрыСведений.НастройкиФорматаОбмена.СоздатьНаборЗаписей();
		НЗ.Отбор.НастройкаОбмена.Установить(Ссылка);
		НЗ.Прочитать();
		Если НЗ.Количество() Тогда
			ЭлементыФормы.НаличиеНастройкиФорматов.Заголовок = " >> Есть настройка форматов << ";	
			ЭлементыФормы.НаличиеНастройкиФорматов.ЦветТекста = Новый Цвет(159,101,0);
		Иначе
			ЭлементыФормы.НаличиеНастройкиФорматов.Заголовок = " >> Отсутствует настройка форматов << ";
			ЭлементыФормы.НаличиеНастройкиФорматов.ЦветТекста = Новый Цвет(255,0,0);
		КонецЕсли;	
		
		
	КонецЕсли;
	
	АктивностьПриИзменении("");
	
КонецПроцедуры

Процедура кнНастройкаФорматовОбменаНажатие(Элемент)
	
	Если ЭтоНовый() Тогда
		Предупреждение("Перед вызовом настройки форматов необходимо записать элемент");
		Возврат;
	КонецЕсли;	
	
	Настройка = ЭтотОбъект.ПолучитьФорму("НастройкаФормата");
	Настройка.ВладелецФормы = ЭтаФорма;
	Настройка.КодКонтракта = Код;
	Настройка.НастройкаОбмена = Ссылка;
	Настройка.ОткрытьМодально();
	
	
КонецПроцедуры

Процедура АктивностьПриИзменении(Элемент)
	
	Если Активность = Ложь Тогда
		ЭлементыФормы.Активность.ЦветТекста = Новый Цвет(255,0,0);
	Иначе
		ЭлементыФормы.Активность.ЦветТекста = Новый Цвет(65,48,3);
	КонецЕсли;
	
КонецПроцедуры

Процедура кнПривязкаКонтрактовНажатие(Элемент)
	
	Настройка = ЭтотОбъект.ПолучитьФорму("СписокКонтрактов");
	Настройка.ВладелецФормы = ЭтаФорма;
	Настройка.ОткрытьМодально();
	
	
	
КонецПроцедуры

Процедура КоэффициентыГруппНаценокПередНачаломДобавления(Элемент, Отказ, Копирование)
	
	Настройка = ЭтотОбъект.ПолучитьФорму("ФормаВыбораГруппНаценок");
	Настройка.ВладелецФормы = ЭтаФорма;
	Настройка.СписокСуществующихГрупп = КоэффициентыГруппНаценок.ВыгрузитьКолонку("ГруппаНаценки");
	Настройка.ОткрытьМодально();	
	
	Отказ = Истина;
	
	
КонецПроцедуры

Процедура ОбработкаВыбора(ЗначениеВыбора, Источник)
	
	Если ТипЗнч(ЗначениеВыбора) = Тип("СписокЗначений") Тогда
		Для каждого стр из ЗначениеВыбора Цикл
			НоваяСтрока = КоэффициентыГруппНаценок.Добавить();
			НоваяСтрока.ГруппаНаценки = стр.Значение;
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры
