
Процедура КоманднаяПанельБланкЗагрузитьИзФайла(Кнопка)
	
	Режим = РежимДиалогаВыбораФайла.Открытие;
	
	ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим);
	
	ДиалогОткрытияФайла.ПолноеИмяФайла		= "";
	ДиалогОткрытияФайла.Фильтр				= "Файлы Excel(*.xls*)|*.xls*";
	ДиалогОткрытияФайла.МножественныйВыбор	= Ложь;
	ДиалогОткрытияФайла.Заголовок			= "Выберите файл";
	
	Если ДиалогОткрытияФайла.Выбрать() Тогда
		ПутьКФайлу = ДиалогОткрытияФайла.ПолноеИмяФайла;
		БланкПредставление = СтрЗаменить(ПутьКФайлу, ДиалогОткрытияФайла.Каталог, "");
		
		ДД = Новый ДвоичныеДанные(ПутьКФайлу); 
        ХЗ = Новый ХранилищеЗначения(ДД, Новый СжатиеДанных(9));
		БланкХЗ = ХЗ;
		
	КонецЕсли;
	
	УстановитьДоступностьЭлементовФормы();
	
КонецПроцедуры

Процедура КоманднаяПанельБланкСохранитьВФайл(Кнопка)
	
	Режим = РежимДиалогаВыбораФайла.ВыборКаталога;
	
	ДиалогОткрытия = Новый ДиалогВыбораФайла(Режим);
	
	ДиалогОткрытия.Каталог 			  = "";
	ДиалогОткрытия.МножественныйВыбор = Ложь;
	ДиалогОткрытия.Заголовок 		  = "Выберите каталог";
	
	Если ДиалогОткрытия.Выбрать() Тогда
		ПутьККаталогу = ДиалогОткрытия.Каталог;
		ПутьКФайлу = ПутьККаталогу + "\" + БланкПредставление;
		
		ДД = БланкХЗ.Получить();		
		ДД.Записать(ПутьКФайлу);
		
		Сообщить("Записан файл: " + ПутьКФайлу);
		
	КонецЕсли;

КонецПроцедуры

Процедура КоманднаяПанельБланкОткрыть(Кнопка)
	
	ПутьКФайлу = КаталогВременныхФайлов() + "\" + БланкПредставление;
	
	ДД = БланкХЗ.Получить();		
	ДД.Записать(ПутьКФайлу);
	
	ЗапуститьПриложение(ПутьКФайлу);
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	УстановитьДоступностьЭлементовФормы();
	
КонецПроцедуры

Процедура УстановитьДоступностьЭлементовФормы()

	УказанБланк = ЗначениеЗаполнено(БланкПредставление);
	Кнопки = ЭлементыФормы.КоманднаяПанельБланк.Кнопки;
	Кнопки.СохранитьВФайл.Доступность = УказанБланк;
	Кнопки.Открыть.Доступность = УказанБланк;

КонецПроцедуры

