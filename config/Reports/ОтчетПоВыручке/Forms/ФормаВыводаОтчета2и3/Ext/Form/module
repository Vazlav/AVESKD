Процедура КоманднаяПанель2Печать(Кнопка)
	
	Если Вопрос("Отправить таблицу на печать?",РежимДиалогаВопрос.ДаНет)<>КодВозвратаДиалога.Да Тогда
		Возврат;
	КонецЕсли;	
	
	ОтметкаАудита(ОбъектВладелец,ЭтаФорма,"Печать таблицы, Форма №"+НомерФормы);
	ЭлементыФормы.ПТД.Вывод=ИспользованиеВывода.Разрешить;
	ЭлементыФормы.ПТД.Напечатать();
	ЭлементыФормы.ПТД.Вывод=ИспользованиеВывода.Запретить;

КонецПроцедуры

Процедура КоманднаяПанель2Сохранить(Кнопка)
   ДВФ=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);
	ДВФ.Фильтр="*.XLS|*.XLS";
	ДВФ.ИндексФильтра=0;
	ДВФ.Выбрать();
	ОтметкаАудита(ОбъектВладелец,ЭтаФорма,"Сохранение таблицы , Форма №"+НомерФормы+" в "+Символы.ПС+ДВФ.ПолноеИмяФайла);
	ЭлементыФормы.ПТД.Вывод=ИспользованиеВывода.Разрешить;
	ЭлементыФормы.ПТД.Записать(ДВФ.ПолноеИмяФайла,ТипФайлаТабличногоДокумента.XLS);
	ЭлементыФормы.ПТД.Вывод=ИспользованиеВывода.Запретить;
КонецПроцедуры

Процедура ПриОткрытии()
	ЭлементыФормы.ПТД.Вывод=ИспользованиеВывода.Запретить;
	ЭлементыФормы.ПТД.Защита=Истина;
	ЭлементыФормы.ПТД.ТолькоПросмотр=Истина;
	ЭлементыФормы.ПТД.ОтображатьСетку=Ложь;
	ЭлементыФормы.ПТД.ОтображатьЗаголовки=Ложь;
	ЭтаФорма.Заголовок="Выручка, Форма-"+НомерФормы;

КонецПроцедуры

Процедура КоманднаяПанель2ОткрытьДоступ(Кнопка)
	
	ВВП=ЭтаФорма.ВладелецФормы.ОтчетОбъект.ПолучитьФорму("ВводПароля");
	ВВП.ОткрытьМодально();
	Если ВВП.ПарольПравильный=Истина Тогда
		ОтметкаАудита(ЭтаФорма.ВладелецФормы.ОтчетОбъект,ЭтаФорма,"Открыт доступ к таблице, пароль правильный.");
	    ЭлементыФормы.ПТД.Защита=Ложь;
		ЭлементыФормы.ПТД.Вывод=ИспользованиеВывода.Разрешить;
	Иначе	
		ОтметкаАудита(ЭтаФорма.ВладелецФормы.ОтчетОбъект,ЭтаФорма,"Попытка открыть доступ к таблице, пароль НЕ правильный.");
		Предупреждение("ГЫ! Не угадал!",2);
	КонецЕсли;
КонецПроцедуры
