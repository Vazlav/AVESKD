
Процедура ПутьКФайлуНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	ВыборФайла(Элемент);
	
КонецПроцедуры

Процедура ВыборФайла(Элемент)

	ДиалогВыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);

	ДиалогВыбораФайла.Фильтр                  = "Файл Microsoft Excel (*.xls*)|*.xls*";
	ДиалогВыбораФайла.Заголовок               = "Выберите файл";
	ДиалогВыбораФайла.ПредварительныйПросмотр = Ложь;		
	ДиалогВыбораФайла.ИндексФильтра           = 0;
	ДиалогВыбораФайла.ПолноеИмяФайла          = Элемент.Значение;
	ДиалогВыбораФайла.ПроверятьСуществованиеФайла = Истина;

	Если ДиалогВыбораФайла.Выбрать() Тогда
		Элемент.Значение = ДиалогВыбораФайла.ПолноеИмяФайла;
	КонецЕсли;

КонецПроцедуры

Процедура КоманднаяПанель1Выполнить(Кнопка)
	
	Если ЗначениеЗаполнено(ПутьКФайлу) Тогда
		Закрыть(ПутьКФайлу);
	Иначе
		Сообщить("Не указан путь к файлу!", СтатусСообщения.Внимание);
	КонецЕсли;
	
КонецПроцедуры

Процедура ПриОткрытии()
	ПутьКФайлу = ВосстановитьЗначение(ЭтотОбъект.Метаданные().Имя + "_ПутьКФайлуСпискаТоваров");
КонецПроцедуры

Процедура ПриЗакрытии()
	СохранитьЗначение(ЭтотОбъект.Метаданные().Имя + "_ПутьКФайлуСпискаТоваров", ПутьКФайлу);
КонецПроцедуры


