
Процедура КнопкаСформироватьНажатие(Кнопка)
	Построитель.Параметры.Очистить();
	Построитель.Параметры.Вставить("Дата1",НачалоДня(НачПериода));
	Построитель.Параметры.Вставить("Дата2",КонецДня(КонПериода));
	
	Построитель.Параметры.Вставить("ФормироватьНачОст",НачальныйОстаток);
	Построитель.Параметры.Вставить("ФормироватьПриход",Приход);
	Построитель.Параметры.Вставить("ФормироватьРасход",Расход);
	Построитель.Параметры.Вставить("ФормироватьКонОст",КонечныйОстаток);
	
	
	Построитель.Выполнить();
	
	Построитель.МакетОформления=ПолучитьМакетОформления(СтандартноеОформление.Бронза);
	
	Построитель.ОформитьМакет();
	
	Построитель.Вывести();
	
	
	
КонецПроцедуры

Процедура ВыбПериодНажатие(Элемент)
	НастройкаПериода = Новый НастройкаПериода;
	НастройкаПериода.УстановитьПериод(НачПериода, ?(КонПериода='0001-01-01', КонПериода, КонецДня(КонПериода)));
	НастройкаПериода.РедактироватьКакИнтервал = Истина;
	НастройкаПериода.РедактироватьКакПериод = Истина;
	НастройкаПериода.ВариантНастройки = ВариантНастройкиПериода.Период;
	Если НастройкаПериода.Редактировать() Тогда
		НачПериода = НастройкаПериода.ПолучитьДатуНачала();
		КонПериода = НастройкаПериода.ПолучитьДатуОкончания();
	КонецЕсли;
КонецПроцедуры


Построитель.Текст="ВЫБРАТЬ
                  |	АрбитражОстатки.Товар,
                  |	АрбитражОстатки.Склад,
                  |	АрбитражОстатки.Партия,
                  |	АрбитражОстатки.СтавкаНДС,
                  |	АрбитражОстатки.Фирма,
                  |	АрбитражОстатки.КолвоОстаток КАК НачОст_Колво,
                  |	АрбитражОстатки.СуммаЗакупСНДСОстаток КАК НачОст_Закуп,
                  |	АрбитражОстатки.СуммаНДСЗакупОстаток КАК НачОст_НДСЗакуп,
                  |	АрбитражОстатки.СуммаРознСНДСОстаток КАК НачОст_Розн,
                  |	АрбитражОстатки.СуммаРознНДСОстаток КАК НачОст_НДСРозн
                  |ПОМЕСТИТЬ НачОст
                  |ИЗ
                  |	РегистрНакопления.Арбитраж.Остатки(&Дата1, {(Склад).*, (Партия).*, (Товар).*}) КАК АрбитражОстатки
                  |ГДЕ
                  |	&ФормироватьНачОст = ИСТИНА
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  |	АрбитражОбороты.Товар,
                  |	АрбитражОбороты.Склад,
                  |	АрбитражОбороты.Партия,
                  |	АрбитражОбороты.СтавкаНДС,
                  |	АрбитражОбороты.Фирма,
                  |	АрбитражОбороты.КолвоПриход,
                  |	АрбитражОбороты.СуммаЗакупСНДСПриход,
                  |	АрбитражОбороты.СуммаНДСЗакупПриход,
                  |	АрбитражОбороты.СуммаРознСНДСПриход,
                  |	АрбитражОбороты.СуммаРознНДСПриход
                  |ПОМЕСТИТЬ Приход
                  |ИЗ
                  |	РегистрНакопления.Арбитраж.Обороты(&Дата1, &Дата2, Регистратор, {(Склад).*, (Партия).*, (Товар).*}) КАК АрбитражОбороты
                  |ГДЕ
                  |	&ФормироватьПриход = ИСТИНА
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  |	АрбитражОбороты.Товар,
                  |	АрбитражОбороты.Склад,
                  |	АрбитражОбороты.Партия,
                  |	АрбитражОбороты.СтавкаНДС,
                  |	АрбитражОбороты.Фирма,
                  |	АрбитражОбороты.КолвоРасход,
                  |	АрбитражОбороты.СуммаЗакупСНДСРасход,
                  |	АрбитражОбороты.СуммаНДСЗакупРасход,
                  |	АрбитражОбороты.СуммаРознСНДСРасход,
                  |	АрбитражОбороты.СуммаРознНДСРасход
                  |ПОМЕСТИТЬ Расход
                  |ИЗ
                  |	РегистрНакопления.Арбитраж.Обороты(&Дата1, &Дата2, Регистратор, {(Склад).*, (Партия).*, (Товар).*}) КАК АрбитражОбороты
                  |ГДЕ
                  |	&ФормироватьРасход = ИСТИНА
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  |	АрбитражОстатки.Товар,
                  |	АрбитражОстатки.Склад,
                  |	АрбитражОстатки.Партия,
                  |	АрбитражОстатки.СтавкаНДС,
                  |	АрбитражОстатки.Фирма,
                  |	АрбитражОстатки.КолвоОстаток,
                  |	АрбитражОстатки.СуммаЗакупСНДСОстаток,
                  |	АрбитражОстатки.СуммаНДСЗакупОстаток,
                  |	АрбитражОстатки.СуммаРознСНДСОстаток,
                  |	АрбитражОстатки.СуммаРознНДСОстаток
                  |ПОМЕСТИТЬ КонОст
                  |ИЗ
                  |	РегистрНакопления.Арбитраж.Остатки(&Дата2, {(Склад).*, (Партия).*, (Товар).*}) КАК АрбитражОстатки
                  |ГДЕ
                  |	&ФормироватьКонОст = ИСТИНА
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  |	ВЫБОР
                  |		КОГДА КонОст.Товар ЕСТЬ НЕ NULL 
                  |			ТОГДА КонОст.Товар
                  |		КОГДА НачОст.Товар ЕСТЬ НЕ NULL 
                  |			ТОГДА НачОст.Товар
                  |		КОГДА Приход.Товар ЕСТЬ НЕ NULL 
                  |			ТОГДА Приход.Товар
                  |		КОГДА Расход.Товар ЕСТЬ НЕ NULL 
                  |			ТОГДА Расход.Товар
                  |		ИНАЧЕ NULL
                  |	КОНЕЦ КАК Товар,
                  |	ВЫБОР
                  |		КОГДА КонОст.Склад ЕСТЬ НЕ NULL 
                  |			ТОГДА КонОст.Склад
                  |		КОГДА НачОст.Склад ЕСТЬ НЕ NULL 
                  |			ТОГДА НачОст.Склад
                  |		КОГДА Приход.Склад ЕСТЬ НЕ NULL 
                  |			ТОГДА Приход.Склад
                  |		КОГДА Расход.Склад ЕСТЬ НЕ NULL 
                  |			ТОГДА Расход.Склад
                  |		ИНАЧЕ NULL
                  |	КОНЕЦ КАК Склад,
                  |	ВЫБОР
                  |		КОГДА КонОст.Партия ЕСТЬ НЕ NULL 
                  |			ТОГДА КонОст.Партия
                  |		КОГДА НачОст.Партия ЕСТЬ НЕ NULL 
                  |			ТОГДА НачОст.Партия
                  |		КОГДА Приход.Партия ЕСТЬ НЕ NULL 
                  |			ТОГДА Приход.Партия
                  |		КОГДА Расход.Партия ЕСТЬ НЕ NULL 
                  |			ТОГДА Расход.Партия
                  |		ИНАЧЕ NULL
                  |	КОНЕЦ КАК Партия,
                  |	ВЫБОР
                  |		КОГДА КонОст.СтавкаНДС ЕСТЬ НЕ NULL 
                  |			ТОГДА КонОст.СтавкаНДС
                  |		КОГДА НачОст.СтавкаНДС ЕСТЬ НЕ NULL 
                  |			ТОГДА НачОст.СтавкаНДС
                  |		КОГДА Приход.СтавкаНДС ЕСТЬ НЕ NULL 
                  |			ТОГДА Приход.СтавкаНДС
                  |		КОГДА Расход.СтавкаНДС ЕСТЬ НЕ NULL 
                  |			ТОГДА Расход.СтавкаНДС
                  |		ИНАЧЕ NULL
                  |	КОНЕЦ КАК СтавкаНДС,
                  |	ВЫБОР
                  |		КОГДА КонОст.Фирма ЕСТЬ НЕ NULL 
                  |			ТОГДА КонОст.Фирма
                  |		КОГДА НачОст.Фирма ЕСТЬ НЕ NULL 
                  |			ТОГДА НачОст.Фирма
                  |		КОГДА Приход.Фирма ЕСТЬ НЕ NULL 
                  |			ТОГДА Приход.Фирма
                  |		КОГДА Расход.Фирма ЕСТЬ НЕ NULL 
                  |			ТОГДА Расход.Фирма
                  |		ИНАЧЕ NULL
                  |	КОНЕЦ КАК Фирма,
                  |	КонОст.КолвоОстаток КАК КонОст,
                  |	КонОст.СуммаЗакупСНДСОстаток КАК КонОст_Закуп,
                  |	КонОст.СуммаНДСЗакупОстаток КАК КонОст_НДСЗакуп,
                  |	КонОст.СуммаРознСНДСОстаток КАК КонОст_Розн,
                  |	КонОст.СуммаРознНДСОстаток КАК КонОст_НДСРозн,
                  |	НачОст.НачОст_Колво,
                  |	НачОст.НачОст_Закуп,
                  |	НачОст.НачОст_НДСЗакуп,
                  |	НачОст.НачОст_Розн,
                  |	НачОст.НачОст_НДСРозн,
                  |	Приход.КолвоПриход КАК Приход_Колво,
                  |	Приход.СуммаЗакупСНДСПриход КАК Приход_Закуп,
                  |	Приход.СуммаНДСЗакупПриход КАК Приход_НДСЗакуп,
                  |	Приход.СуммаРознСНДСПриход КАК Приход_Розн,
                  |	Приход.СуммаРознНДСПриход КАК Приход_НДСРозн,
                  |	Расход.КолвоРасход КАК Расход_Колво,
                  |	Расход.СуммаЗакупСНДСРасход КАК Расход_Закуп,
                  |	Расход.СуммаНДСЗакупРасход КАК Расход_НДСЗакуп,
                  |	Расход.СуммаРознСНДСРасход КАК Расход_Розн,
                  |	Расход.СуммаРознНДСРасход КАК Расход_НДСРозн
                  |{ВЫБРАТЬ
                  |	Товар.*,
                  |	Склад.*,
                  |	Партия.*,
                  |	СтавкаНДС.*,
                  |	Фирма.*,
                  |	КонОст,
                  |	КонОст_Закуп,
                  |	КонОст_НДСЗакуп,
                  |	КонОст_Розн,
                  |	КонОст_НДСРозн,
                  |	НачОст_Колво,
                  |	НачОст_Закуп,
                  |	НачОст_НДСЗакуп,
                  |	НачОст_Розн,
                  |	НачОст_НДСРозн,
                  |	Приход_Колво,
                  |	Приход_Закуп,
                  |	Приход_НДСЗакуп,
                  |	Приход_Розн,
                  |	Приход_НДСРозн,
                  |	Расход_Колво,
                  |	Расход_Закуп,
                  |	Расход_НДСЗакуп,
                  |	Расход_Розн,
                  |	Расход_НДСРозн}
                  |ИЗ
                  |	НачОст КАК НачОст
                  |		ПОЛНОЕ СОЕДИНЕНИЕ Приход КАК Приход
                  |		ПО НачОст.Партия = Приход.Партия
                  |			И НачОст.Склад = Приход.Склад
                  |			И НачОст.СтавкаНДС = Приход.СтавкаНДС
                  |			И НачОст.Фирма = Приход.Фирма
                  |		ПОЛНОЕ СОЕДИНЕНИЕ Расход КАК Расход
                  |		ПО НачОст.Партия = Расход.Партия
                  |			И НачОст.Склад = Расход.Склад
                  |			И НачОст.СтавкаНДС = Расход.СтавкаНДС
                  |			И НачОст.Фирма = Расход.Фирма
                  |		ПОЛНОЕ СОЕДИНЕНИЕ КонОст КАК КонОст
                  |		ПО НачОст.Партия = КонОст.Партия
                  |			И НачОст.Склад = КонОст.Склад
                  |			И НачОст.СтавкаНДС = КонОст.СтавкаНДС
                  |			И НачОст.Фирма = КонОст.Фирма";
