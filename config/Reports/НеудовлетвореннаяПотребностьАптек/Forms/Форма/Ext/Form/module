
Процедура КнопкаСформироватьНажатие(Кнопка)
	// Вставить содержимое обработчика.
	
	Сообщить( ЭлементыФормы.Переключатель1.Данные);
	Сообщить( ЭлементыФормы.Переключатель2.Данные);
	Сообщить( "----------------------");
	
	ТХТПоОбиженным="ВЫБРАТЬ
	               |	НПАптекОстатки.Склад КАК Склад,
	               |	НПАптекОстатки.Товар КАК ТоварСсылка,
	               |	СУММА(НПАптекОстатки.КоличествоОстаток) КАК КоличествоОстаток
	               |ИЗ
	               |	РегистрНакопления.НПАптек.Остатки КАК НПАптекОстатки
	               |
	               |СГРУППИРОВАТЬ ПО
	               |	НПАптекОстатки.Склад,
	               |	НПАптекОстатки.Товар
	               |ИТОГИ ПО
	               |	ТоварСсылка";
		
	ТХТБезДетализации="ВЫБРАТЬ
	                  |	НПАптекОстатки.Товар КАК ТоварСсылка,
	                  |	СУММА(НПАптекОстатки.КоличествоОстаток) КАК КоличествоОстаток
	                  |ИЗ
	                  |	РегистрНакопления.НПАптек.Остатки(, ) КАК НПАптекОстатки
	                  |
	                  |СГРУППИРОВАТЬ ПО
	                  |	НПАптекОстатки.Товар";
		
		
		
		
		
		Запрос=Новый Запрос;
		
		Запрос.Текст=ТХТПоОбиженным;
		
		ТЗ=Запрос.Выполнить().Выгрузить(ОбходРезультатаЗапроса.ПоГруппировкамСИерархией );
		
		
		ЭлементыФормы.ТабличноеПоле1.Значение=ТЗ;
		ЭлементыФормы.ТабличноеПоле1.СоздатьКолонки();
		
	
	
	
КонецПроцедуры
