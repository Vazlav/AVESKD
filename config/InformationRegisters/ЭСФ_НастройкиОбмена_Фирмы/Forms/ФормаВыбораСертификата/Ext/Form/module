
Процедура СертификатыПередНачаломИзменения(Элемент, Отказ)
	Отказ = Истина;
КонецПроцедуры


Процедура СоздатьНажатие(Элемент)
	
	ТекСтр=ЭлементыФормы.Сертификаты.ТекущаяСтрока;
	
	СтруктураВыбора=Новый Структура();
	
	Для Каждого Кол Из Сертификаты.Колонки Цикл
		СтруктураВыбора.Вставить(Кол.Имя,ТекСтр[Кол.Имя]);
	КонецЦикла;	
	
	ОповеститьОВыборе(СтруктураВыбора);
КонецПроцедуры


Процедура ПриОткрытии()
	 Диадок=Обработки.ЭСФ_Робот_20140903.Создать();
	 DiadocInvoiceAPI=Диадок.DiadocInvoiceAPI;
	 ДанныеПоСертификатам=DiadocInvoiceAPI.GetPersonalCertificates(); // массив ком объектов
	 
	 Если ДанныеПоСертификатам.количество()=0 тогда
		 Предупреждение("Не найдено ни одного сертификата!");
		 Возврат;
	КонецЕсли;	 
	 
	// ДанныеПоСертификатам поля ком объекта:
	// Name	beginDate	endDate	Thumbprint	IssuerName	IsKontur	OrganizationName
	
	Для Каждого КомОбъект Из ДанныеПоСертификатам Цикл
		
		СтрокаСертификата=Сертификаты.Добавить();
		СтрокаСертификата.Наименование=КомОбъект.Name;
		СтрокаСертификата.НачалоДействия=  КомОбъект.beginDate;
		СтрокаСертификата.ОкончаниеДействия= КомОбъект.endDate;
		СтрокаСертификата.Организация     =  КомОбъект.OrganizationName;
		СтрокаСертификата.ОтпечатокСертификата = КомОбъект.Thumbprint;
		СтрокаСертификата.Издатель            =  КомОбъект.IssuerName;
		СтрокаСертификата.ЭтоСертификатКонтура=  КомОбъект.IsKontur;
	КонецЦикла;	
КонецПроцедуры

Процедура СертификатыВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	СтандартнаяОбработка=Ложь;
КонецПроцедуры
