
Процедура ДействияФормыПерезаполнитьТаблицуРоутинга(Кнопка)
	
	
	ЭлементыФормы.Индикатор1.Видимость=Истина;
	
	Маршрутизатор=Обработки.МаршрутизаторПоМетро.Создать();
	
	
	НЗ=РегистрыСведений.РоутингПоМетро.СоздатьНаборЗаписей();
	НЗ.Прочитать();
	НЗ.Очистить();
	НЗ.Записать();
	
	Запрос=Новый Запрос("ВЫБРАТЬ
	                    |	Метро.Ссылка
	                    |ИЗ
	                    |	Справочник.Метро КАК Метро
	                    |
	                    |УПОРЯДОЧИТЬ ПО
	                    |	Метро.ЛинияМетро,
	                    |	Метро.НомерСтанцииВЛинии");
	
	Рез=Запрос.Выполнить().Выгрузить();
	
	ЭлементыФормы.Индикатор1.Значение=0;
	ЭлементыФормы.Индикатор1.МаксимальноеЗначение=Рез.Количество();
	
	Для Каждого Стр Из Рез Цикл
		
		Маршрутизатор.ИспользоватьПересадки=Истина;
		Маршрутизатор.МаксимальноеКолвоПересадок=3;
		Маршрутизатор.МаксимальноеУдалениеОтКлиента=10000000;
		Маршрутизатор.СтанцияКлиента=Стр.Ссылка;
		
		ТаблицаМетро=Маршрутизатор.ПолучитьСписокСтанцийМетро();
		
		
		Для Каждого СтрТМ из ТаблицаМетро Цикл
			
			СтрокаРегистра=НЗ.Добавить();
			СтрокаРегистра.СтанцияОтправления=Стр.Ссылка;
			СтрокаРегистра.СтанцияПрибытия=СтрТМ.Метро;
			СтрокаРегистра.Удаленность=СтрТМ.УдаленностьОтКлиента;
			
			
		КонецЦикла;	
		
		
		ЭлементыФормы.Индикатор1.Значение=ЭлементыФормы.Индикатор1.Значение+1;
		
	КонецЦикла;
	
	НЗ.Записать();
	
	ЭлементыФормы.Индикатор1.Видимость=Ложь;

	
КонецПроцедуры
