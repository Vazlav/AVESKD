
Процедура КнопкаВыполнитьНажатие(Кнопка)
	    //------------------<передать наружу результат выборки и простановки галочек>-------------------GtG----11.12.2007
		
		Рез= Новый СписокЗначений; 
		Для каждого Стр из ОтобранныеПозицииАП Цикл
			Если Стр.Пометка=Ложь ТОгда
				ПРодолжить;
			КонецЕсли; 
			
			Рез.Добавить(Стр.Значение);
		КонецЦикла;	
		
		Если Рез.Количество()=0 Тогда
			Рез= Неопределено;
		КонецЕсли; 	
		
		
	   ЭтаФорма.ОповеститьОВыборе(Рез); // только то что отмечено
КонецПроцедуры

Процедура КоманднаяПанель3Обратить(Кнопка)
	
	Для каждого Стр из ОтобранныеПозицииАП Цикл
		Стр.Пометка=Не Стр.Пометка;
	КонецЦикла;
	
	ОбновлениеСчетчикаОтмеченных();
	
КонецПроцедуры

Процедура КоманднаяПанель3Разотметить(Кнопка)
	Для каждого Стр из ОтобранныеПозицииАП Цикл
		Стр.Пометка=Ложь;
	КонецЦикла;
	ОбновлениеСчетчикаОтмеченных();

КонецПроцедуры

Процедура КоманднаяПанель3ОтметитьВсе(Кнопка)
	Для каждого Стр из ОтобранныеПозицииАП Цикл
		Стр.Пометка=Истина;
	КонецЦикла;
	ОбновлениеСчетчикаОтмеченных();

КонецПроцедуры

Процедура Кнопка1Нажатие(Элемент)
	ПостроительОтчета.Выполнить();
	
    ТЗ=ПостроительОтчета.Результат.Выгрузить();
	
		
	
	
	ОтобранныеПозицииАП.ЗагрузитьЗначения(ТЗ.ВыгрузитьКолонку("Ссылка"));
	 Для каждого Стр из ОтобранныеПозицииАП Цикл
		Стр.Пометка=Истина;
	КонецЦикла;
    ОбновлениеСчетчикаОтмеченных();

КонецПроцедуры


Процедура ОбновлениеСчетчикаОтмеченных()
	Отмечено=0;
	Для каждого Стр из ОтобранныеПозицииАП Цикл
		Если  Стр.Пометка=Истина Тогда
			Отмечено=Отмечено+1;
		КонецЕсли; 	
	КонецЦикла;	 
	
	ЭлементыФормы.СчетчикОтобранных.Заголовок="В списке: "+ОтобранныеПозицииАП.Количество()+"  отмечено:"+Отмечено;
КонецПроцедуры

	

Процедура ОтобранныеПозицииАППриАктивизацииСтроки(Элемент)
	
	  ОбновлениеСчетчикаОтмеченных();
КонецПроцедуры

Процедура ОтобранныеПозицииАППриИзмененииФлажка(Элемент)
	ОбновлениеСчетчикаОтмеченных();
КонецПроцедуры

Если ПустаяСтрока(ТекстЗапроса) Тогда
	
	ПостроительОтчета.Текст="ВЫБРАТЬ
	|	АССОРТИМЕНТНЫЙ_ПЛАН.Ссылка
	|{ВЫБРАТЬ
	|	АССОРТИМЕНТНЫЙ_ПЛАН.Ссылка}
	|ИЗ
	|	Справочник.АССОРТИМЕНТНЫЙ_ПЛАН КАК АССОРТИМЕНТНЫЙ_ПЛАН
	|{ГДЕ
	|	АССОРТИМЕНТНЫЙ_ПЛАН.Ссылка.* как Товар}
	|{УПОРЯДОЧИТЬ ПО
	|	АССОРТИМЕНТНЫЙ_ПЛАН.Наименование}";
	
Иначе		
	ПостроительОтчета.Текст=ТекстЗапроса;
КонецЕсли;


		