
Процедура КнопкаВыполнитьНажатие(Кнопка)
	Послать();	
КонецПроцедуры

Процедура КоманднаяПанель2ДобавитьВложение(Кнопка)
	// Вставить содержимое обработчика.
	
	ДВФ=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДВФ.МножественныйВыбор=Ложь;
	ДВФ.Заголовок="Выбрать файл вложения";
	
	Если ДВФ.Выбрать() Тогда
		СписокВложений.Добавить(ДВФ.ПолноеИмяФайла);
	КонецЕсли;	
КонецПроцедуры

Процедура КоманднаяПанель2УдалитьВложение(Кнопка)
	// Вставить содержимое обработчика.
	СЗ=ЭлементыФормы.СВ.ТекущаяСтрока;
	ЭлементыФормы.СВ.Значение.Удалить(СЗ);
КонецПроцедуры

Процедура КоманднаяПанель3УдалитьАдрес(Кнопка)
	СЗ=ЭлементыФормы.Рассылка.ТекущаяСтрока;
	ЭлементыФормы.Рассылка.Значение.Удалить(СЗ);
КонецПроцедуры

Процедура КоманднаяПанель3ДобавитьАдрес(Кнопка)
	// Вставить содержимое обработчика.
	СЗ=Новый СписокЗначений;
	СЗ.Добавить("Адрес");
	СЗ.Добавить("Из справочника мест хранения");
	
	Рез=СЗ.ВыбратьЭлемент("Способ ввода");
	ЕСли Рез= Неопределено ТОгда
		Возврат;
	КонецЕсли;
	
	ЕСли Рез.Значение="Адрес" Тогда
		Адр="";
		ЕСли ВвестиСтроку(Адр,"Адрес эл. почты",50,Ложь)=Истина ТОгда
			РАссылка.Добавить(Адр);
		КонецЕсли; 
	КонецЕсли;
	
	ЕСли Рез.Значение="Из справочника мест хранения" Тогда
		СА=Новый СписокЗначений;
		
		ТХТ="ВЫБРАТЬ
		|	МестаХранения.Наименование как МХ,
		|	МестаХранения.Мэйл как Мыло
		|ИЗ
		|	Справочник.МестаХранения КАК МестаХранения
		|ГДЕ
		|	МестаХранения.Мэйл <> &Мэйл";
		
		ЗАпрос=Новый Запрос;
		Запрос.Текст=ТХТ;
		Запрос.УстановитьПараметр("Мэйл","");
		ТЗ=Запрос.Выполнить().Выгрузить();
		
		Для каждого Стр из ТЗ Цикл
			СА.Добавить(Стр.Мыло,Стр.МХ);
		КонецЦикла;	 
		
		Адр=СА.ВыбратьЭлемент("Адрес"); 
		Если Адр<> Неопределено Тогда
			РАссылка.Добавить(Адр.Значение);
		КонецЕсли; 
	КонецЕсли;
КонецПроцедуры

Процедура ПриОткрытии()
	
	//ЕСли Автоотправка=Истина ТОгда
	//	
	//	Послать();
	//КонецЕсли; 	
	
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	ЕСли Автоотправка=Истина ТОгда
		Послать();
		Закрыть();
	КонецЕсли; 	

КонецПроцедуры

 
Если (ПустаяСтрока(Адресат)=Истина и Рассылка.Количество()=0)  Тогда //или ЭтаФорма.ВладелецФормы= Неопределено
	Адресат="";
	Тема="От склада. ";
	ТекстПисьма="";
КонецЕсли; 