
Процедура ФайлНачалоВыбора(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка=Ложь;
	ДВВФ=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДВВФ.Выбрать();
	Файл=ДВВФ.ПолноеИмяФайла;
КонецПроцедуры

Процедура ОсновныеДействияФормыПолучитьДанныееИзФайлаЧеереезOpenOffice(Кнопка)
	
	Если ТабТипизацииОО.Количество()=0 ТОгда
		Предупреждение("Не настроена типизация колонок. 
					   |Тип данных принимается по умолчанию: 
					   |Строка, длина макс. 150 символов, переменная");
	КонецЕсли;				   
	
	
	ПараметрыФайлаОО=Новый Структура;
	
	ПараметрыФайлаОО.Вставить("ИндексЛиста",ИндексЛиста)         ;
	ПараметрыФайлаОО.Вставить("ИндексПервойКолонки",ИндексПервойКолонки )  ;
	ПараметрыФайлаОО.Вставить("ИндексПервойСтроки",ИндексПервойСтроки   )  ;
	ПараметрыФайлаОО.Вставить("КолвоКолонок",КолвоКолонок )                ;
	ПараметрыФайлаОО.Вставить("КолвоСтрокФайла",КолвоСтрокФайла)           ;
	ПараметрыФайлаОО.Вставить("ТабТипизацииОО",ТабТипизацииОО  )           ;
	ПараметрыФайлаОО.Вставить("Файл",Файл )                                ;
	ПараметрыФайлаОО.Вставить("ТабТипизацииОО",ЭлементыФормы.ТабТипизацииОО.Значение);
	
	ЭтаФорма.ВладелецФормы.ПараметрыФайлаОО=ПараметрыФайлаОО;
	
	Закрыть(); 	// Вставить содержимое обработчика.
КонецПроцедуры


Процедура ЗаполнитьНажатие(Элемент)
	ТабТипизацииОО.Очистить();
	Для Ы=ИндексПервойКолонки По ИндексПервойКолонки+КолвоКолонок-1 Цикл
		Стр=ТабТипизацииОО.Добавить();
		Стр.ИндексКолонки=Ы;
	КонецЦикла;	
КонецПроцедуры


Процедура ДействияФормыСохранитьПараметрыОткрытияФайла(Кнопка)
	
	СтруктураПарам=Новый Структура;
	СтруктураПарам.Вставить("Файл",Файл);
	СтруктураПарам.Вставить("ИндексЛиста",ИндексЛиста);
	СтруктураПарам.Вставить("ИндексПервойСтроки",ИндексПервойСтроки);
	СтруктураПарам.Вставить("ИндексПервойКолонки",ИндексПервойКолонки);
	СтруктураПарам.Вставить("КолвоКолонок",КолвоКолонок);
	СтруктураПарам.Вставить("КолвоСтрокФайла",КолвоСтрокФайла);
	СтруктураПарам.Вставить("ТабТипизацииОО",ТабТипизацииОО);
	
	ИФН=""+Файл+".1C_OPEN_PARAMS";
	ЗначениеВФайл(ИФН,СтруктураПарам);
	Сообщить("Параметры открытия сохранены в файл "+ИФН);
КонецПроцедуры


Процедура ДействияФормыВосстановитьПараметрыОткрытияФайла(Кнопка)
	ДОФ=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДОФ.Фильтр="*.1C_OPEN_PARAMS|*.1C_OPEN_PARAMS";
	ДОФ.Выбрать();
	ИФН=ДОФ.ПолноеИмяФайла;
	
	СтруктураНастроек=ЗначениеИзФайла(ИФН);
	
	
	ИндексЛиста=СтруктураНастроек.ИндексЛиста;
	ИндексПервойСтроки=СтруктураНастроек.ИндексПервойСтроки;
	ИндексПервойКолонки=СтруктураНастроек.ИндексПервойКолонки;
	КолвоКолонок=СтруктураНастроек.КолвоКолонок;
	КолвоСтрокФайла=СтруктураНастроек.КолвоСтрокФайла;
	ТабТипизацииОО=СтруктураНастроек.ТабТипизацииОО;
КонецПроцедуры


Процедура ПриОткрытии()
	
	ПараметрыФайлаОО=ЭтаФорма.ВладелецФормы.ПараметрыФайлаОО;
	
	
	Если ПараметрыФайлаОО=Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	
	ИндексЛиста  = ПараметрыФайлаОО.ИндексЛиста                  ;
	ИндексПервойКолонки = ПараметрыФайлаОО.ИндексПервойКолонки   ;
	ИндексПервойСтроки = ПараметрыФайлаОО.ИндексПервойСтроки     ;
	КолвоКолонок = ПараметрыФайлаОО.КолвоКолонок                 ;
	КолвоСтрокФайла = ПараметрыФайлаОО.КолвоСтрокФайла           ;
	ТабТипизацииОО = ПараметрыФайлаОО.ТабТипизацииОО             ;
	Файл = ПараметрыФайлаОО.Файл                                 ;
	ЭлементыФормы.ТабТипизацииОО.Значение=ПараметрыФайлаОО.ТабТипизацииОО;
	
КонецПроцедуры

