
Процедура КоманднаяПанель1Подключиться(Кнопка)
	Если ПустаяСтрока(Версия1С)=Истина Тогда
		Предупреждение("Не указана версия 1С");
		Возврат;
	КонецЕсли;
	
	ЭтаФорма.ВладелецФормы.ОбработкаОбъект.МодОб_ПодключитьсяНажатие(ФайловаяБаза,Сервер,База,КаталогИБ,Пользователь,Пароль,ЭлементыФормы.Н_СостояниеПодключения,Версия1С);

КонецПроцедуры

Процедура КоманднаяПанель1НастройкиПодключенияВФайл(Кнопка)
	// Вставить содержимое обработчика.
	ДВФ=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);
	ДВФ.Фильтр="Найтройки подключения к базе *.1C_LINK|*.1C_LINK";
	ДВФ.ИндексФильтра=0;
	ДВФ.Выбрать();
	
	
	СтруктураПодключения=Новый Структура("Сервер,КаталогИБ,ФайловаяБаза,Версия1С,База,Пользователь,Пароль",Сервер,КаталогИБ,ФайловаяБаза,Версия1С,База,Пользователь,Пароль);
	
	ЗначениеВФайл( ДВФ.ПолноеИмяФайла,СтруктураПодключения);
	
КонецПроцедуры

Процедура КоманднаяПанель1НастройкиПодключенияИзФайла(Кнопка)
	
	 ДВФ=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДВФ.Фильтр="Найтройки подключения к базе *.1C_LINK|*.1C_LINK";
	ДВФ.ИндексФильтра=0;
	ДВФ.Выбрать();
	
	
	
	СтруктураПодключения=ЗначениеИзФайла(ДВФ.ПолноеИмяФайла);
	
	Сервер=СтруктураПодключения.Сервер;
	КаталогИБ =СтруктураПодключения.КаталогИБ;
	ФайловаяБаза=СтруктураПодключения.ФайловаяБаза;
	База=СтруктураПодключения.База;
	Пользователь=СтруктураПодключения.Пользователь;
	Пароль=СтруктураПодключения.Пароль;
	Версия1С=СтруктураПодключения.Версия1С;
	
	
	
КонецПроцедуры
