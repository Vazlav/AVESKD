
Процедура КнопкаВыполнитьНажатие(Кнопка)
	
	
	
	
	
	  Построитель.Параметры.Очистить();
	  Построитель.Параметры.Вставить("Дата1",НачалоДня(НачПериода));
	  Построитель.Параметры.Вставить("Дата2",КонецДня(КонПериода));
	  Построитель.Выполнить();
	  
	  
	  Упорядочивание=Построитель.Порядок.Найти("Дата_Заказа");
	  Если Упорядочивание=Неопределено Тогда
		  Построитель.Порядок.Добавить("Дата_Заказа");
		  Упорядочивание=Построитель.Порядок.Найти("Дата_Заказа");
	  КонецЕсли;  
	  
	  Если СначалаНовые=1 Тогда
		  Упорядочивание.Направление=НаправлениеСортировки.Убыв;
	  Иначе
		  Упорядочивание.Направление=НаправлениеСортировки.Возр;
	  КонецЕсли;
	  
	  
	  
	  Построитель.МакетОформления=ПолучитьМакетОформления(СтандартноеОформление.Трава);
	  
	  Построитель.ТекстЗаголовка="Отчет по интернет-заказам";
	  Построитель.ОформитьМакет();
	  Построитель.ЗаполнениеРасшифровки=ВидЗаполненияРасшифровкиПостроителяОтчета.Расшифровка;
	  Построитель.Вывести();
	  
	
КонецПроцедуры

Процедура ВыбПериодНажатие(Элемент)
	НастройкаПериода = Новый НастройкаПериода;
	НастройкаПериода.РедактироватьКакИнтервал = Истина;
	НастройкаПериода.РедактироватьКакПериод = Истина;
	НастройкаПериода.ВариантНастройки = ВариантНастройкиПериода.Период;
	НастройкаПериода.УстановитьПериод(НачПериода, ?(КонПериода='0001-01-01', КонПериода, КонецДня(КонПериода)));
	Если НастройкаПериода.Редактировать() Тогда
		НачПериода = НастройкаПериода.ПолучитьДатуНачала();
		КонПериода = НастройкаПериода.ПолучитьДатуОкончания();
	КонецЕсли;
КонецПроцедуры


Построитель.Текст="ВЫБРАТЬ
                  |	ИнтернетЗаказ.Ссылка,
                  |	ИнтернетЗаказ.ТипИсточника КАК Префикс,
                  |	ИнтернетЗаказ.НомерЗаказа,
                  |	ИнтернетЗаказ.ДатаЗаказа,
                  |	ИнтернетЗаказ.ДатаОтгрузки,
                  |	ИнтернетЗаказ.СуммаСоСкидкой,
                  |	ИнтернетЗаказ.СтатусЗаказа,
                  |	ИнтернетЗаказ.Курьер,
                  |	ИнтернетЗаказ.Комментарий
                  |ПОМЕСТИТЬ Заказы
                  |ИЗ
                  |	Документ.ИнтернетЗаказ КАК ИнтернетЗаказ
                  |ГДЕ
                  |	ИнтернетЗаказ.Дата МЕЖДУ &Дата1 И &Дата2
                  |{ГДЕ
                  |	ИнтернетЗаказ.СтатусЗаказа КАК Статус_Заказа,
                  |	ИнтернетЗаказ.Курьер,
                  |	ИнтернетЗаказ.ТипИсточника КАК Префикс}
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  |	МАКСИМУМ(ИнтернетЗаказИзменения.Дата) КАК Дата,
                  |	Заказы.Ссылка
                  |ПОМЕСТИТЬ ДатаПоследнегоИзменения
                  |ИЗ
                  |	Заказы КАК Заказы
                  |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ИнтернетЗаказ.Изменения КАК ИнтернетЗаказИзменения
                  |		ПО Заказы.Ссылка = ИнтернетЗаказИзменения.Ссылка
                  |
                  |СГРУППИРОВАТЬ ПО
                  |	Заказы.Ссылка
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  |	Заказы.Префикс,
                  |	Заказы.НомерЗаказа КАК Номер_заказа,
                  |	Заказы.ДатаЗаказа КАК Дата_заказа,
                  |	Заказы.ДатаОтгрузки КАК Дата_отгрузки,
                  |	Заказы.СуммаСоСкидкой КАК Сумма_со_скидкой,
                  |	Заказы.СтатусЗаказа КАК Статус_Заказа,
                  |	Заказы.Курьер,
                  |	Заказы.Комментарий,
                  |	ДатаПоследнегоИзменения.Дата КАК Дата_Последнего_Изменения,
                  |	Заказы.Ссылка КАК Документ
                  |ИЗ
                  |	Заказы КАК Заказы
                  |		ЛЕВОЕ СОЕДИНЕНИЕ ДатаПоследнегоИзменения КАК ДатаПоследнегоИзменения
                  |		ПО Заказы.Ссылка = ДатаПоследнегоИзменения.Ссылка
                  |
                  |{УПОРЯДОЧИТЬ ПО
                  |	Дата_заказа}";
СначалаНовые=1;